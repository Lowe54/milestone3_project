{% extends 'base.html' %}
{% block content %}
    <div class="row">
    <div class="results-facets">
        <h2 class="text-center">Filter your results:</h2>
        <form method="GET" action="{{url_for('results')}}">
            <div class="form-check">
                <div class="facet">
                    <h3 data-toggle="collapse" data-target="#filter_allergin_body">Allergins&nbsp;<i class="fa fa-chevron-down"></i></h3>
                    <div id="filter_allergin_body" class="collapse">
                        {% for allergin in allerginList %}
                        <label>
                            <input type="checkbox" name="allergin" value="{{allergin}}" {% if request.args.get('allergin') == allergin %} checked="checked" {% endif %}/>
                            {{allergin}}
                        </label>
                            <br/>
                        {% endfor %}
                    </div>
                </div>
                <input type="hidden" name="qt" value="{{currentQueryTerm}}"/>
                <input class="btn btn-success" type="submit" value="Filter my Results"/>
            </div>
        </form>
    </div>
    <div class="result-hits">
        <h2 class="text-center">Results {{sr + 1}} to {% if nh > maxresults %} {{maxresults}} {% else %} {{nh}} {% endif %} of {{maxresults}}</h2>
        {% for res in results  %}
            {% if res.length == 0 %}
                 NO RESULTS
            {% else %}
                {% if loop.index > sr and loop.index <= sr + 10 %}
                    <div id="hit-{{res._id}}" class="result-hit">
                        <header><h4>{{res.recipie_title}}</h4></header>
                        <main>
                            <p>{{res.recipie_description}}</p>
                        </main>
                        <footer>
                            <a href="{{url_for('recipie', id=res._id)}}" class="btn btn-info">View Full Information</a>
                        </footer>
                    </div>
                {% endif %}
            {% endif %}
        {% endfor %}
    </div>
    {% if pc is defined %}       
        <ul id="pagination">
            {% for pn in range(pc) %}
                {% if loop.first %}
                <li><a href="{{  url_for('results', page=pn , sr=0) }}">{{pn}}</a></li>
                {% else %}
                <li><a href="{{  url_for('results', page=pn + 1, sr=(pn * 10)) }}">{{pn}}</a></li>
                {% endif %}
            
            {% endfor %}
        </ul>
    {% endif %}
</div>
{% endblock %}